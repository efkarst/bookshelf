<!-- *********************  Book Overview - title, image, author, genre, pages, description  ********************* -->
<h1><%=@book.title%></h1>

<div class="book-overview">
  <!-- Book Cover Image -->
  <div class='book-image'>
    <%= image_tag @book.cover_image %>
    <% if current_user_finished_book(@book) %>
      <div class='book-read'>Read</div>
    <% end %>
  </div>

  <!-- Book Data: Author, Genre, and Pages -->
  <div class="book-info" >
    <div class="book-fact"> <h3>Author</h3><%= @book.author.name %> </div>
    <div class="book-fact"> <h3>Genre</h3><%= @book.genre.name %> </div>
    <div class="book-fact"> <h3>Pages</h3><%= @book.pages %> </div>
    
    <h3>Rating</h3>
    <div class="book-fact"><%= render 'books/star_rating', {rating: @book.average_rating} %></div>

  </div> <!-- .book-info -->
  
  <!-- Book Description -->
  <div class="book-description">
    <%= strip_tags(@book.description) %>
  </div> <!-- .book-description -->

</div> <!-- .book-overview -->

<!-- *********************  My Activity (if current user && have book in collection)  ********************* -->
    
<div class="book-overview"> <%= add_or_remove_button(@book) %> </div>

<% if current_user_book(@book) %>
  <!-- Mark as Read -->
  <h2>My Reading Activity</h2>
  <div class="book-info">
    <%=form_for @userbook, url: book_user_book_path(@book.id, @userbook.id) do |f| %>
      <%= f.hidden_field 'finished_book', value: 0 %>
      <div class="book-fact">
        <%= f.check_box :finished_book %>
        <%= f.label "Finished reading", class: "checks" %>
      </div>
      <h3><%= f.label :finish_date %></h3>
      <div class="book-fact">
        <%= f.date_select :finish_date, include_blank: true %>
      </div>
      <%= f.submit 'Update Activity', class: "button" %>
    <% end %>
  </div>

  <!-- Update Shelves -->

  <h2>My Shelves</h2>
  <div class="book-info">
    <%= form_for @userbook, url: book_user_book_path(@book.id, @userbook.id) do |f| %>
      <div class="book-fact checkbox-list checks">
        <%= f.collection_check_boxes :shelf_ids, current_user.shelves, :id, :name %>
      </div>
      <h3>Add a New Shelf </h3>
      <div class="book-fact">
        <%= f.text_field :shelf_name %>
      </div>
      <%= f.submit "Update Shelves", class: 'button' %>
    <% end %>
  </div>

  

<% end %>



<!-- *********************  Reviews  ********************* -->


<h2>Reviews</h2>
<% if current_user_book(@book) %>
  <% if current_user_has_reviewed?(@book) %>
    <div class="buttons">
      <%= link_to "Edit your Review", edit_book_review_path(@book, current_users_book_review(@book)), class:"button"%>
      <%= form_tag(book_review_path(@book, current_users_book_review(@book)), method: 'delete') do %>
        <%= submit_tag "Delete Review", class: "button" %>
      <% end %>
    </div>
  <% else %>
    <%= link_to "Add a Review", new_book_review_path(@book), class:"button"%>
  <% end %>
<% end %>

<%@book.reviews.each do |review| %>
  <sh1><%=review.title%></sh1>
  <sh2><%= render 'books/star_rating', {rating: review.rating} %> </sh2>
  <p><%= review.review %> </p>
<%end%>

<% if @book.reviews.empty? %>
  <p>There are no reviews for this book yet.</p>
<% end %>